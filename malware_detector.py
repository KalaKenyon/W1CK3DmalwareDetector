import tkinter as tk
from tkinter import filedialog
import os

# Function to detect potential malware (basic detection algorithm)
def detect_malware(file_path):
    # Add your malware detection logic here
    # For example, you can check file signatures, analyze behavior, or use pattern matching
    
    # For this example, we assume any file with ".exe" extension is flagged as potential malware
    if file_path.lower().endswith(".exe"):
        return True
    else:
        return False

# Function to handle file selection and malware detection
def scan_files():
    directory_path = filedialog.askdirectory()
    if directory_path:
        potential_malware_files.delete(1.0, tk.END)  # Clear previous results
        for root, _, files in os.walk(directory_path):
            for file in files:
                file_path = os.path.join(root, file)
                if detect_malware(file_path):
                    potential_malware_files.insert(tk.END, f"Potential Malware: {file_path}\n", "red")
                else:
                    potential_malware_files.insert(tk.END, f"Safe File: {file_path}\n", "green")

# Create GUI window
root = tk.Tk()
root.title("W1CK3D Malware Detector")

# Create and pack widgets
scan_button = tk.Button(root, text="Scan Files", command=scan_files)
scan_button.pack(pady=20)

potential_malware_files = tk.Text(root, wrap=tk.WORD)
potential_malware_files.pack(expand=True, fill=tk.BOTH, pady=10, padx=10)

# Define tags for text color
potential_malware_files.tag_config("red", foreground="red")
potential_malware_files.tag_config("green", foreground="green")

# Run the GUI event loop
root.mainloop()
